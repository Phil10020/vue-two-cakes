"use strict";(self["webpackChunktwo_cakes"]=self["webpackChunktwo_cakes"]||[]).push([[633],{3041:function(t,e,a){function s(t){return{all:t=t||new Map,on:function(e,a){var s=t.get(e);s?s.push(a):t.set(e,[a])},off:function(e,a){var s=t.get(e);s&&(a?s.splice(s.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var s=t.get(e);s&&s.slice().map((function(t){t(a)})),(s=t.get("*"))&&s.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return n}});const i=s();var n=i},3633:function(t,e,a){a.r(e),a.d(e,{default:function(){return H}});var s=a(6252),i=a(3577),n=a(9963);const l=(0,s._)("div",{class:"banner cart-banner container-fluid d-flex align-items-center justify-content-center"},[(0,s._)("span",{class:"fs-1"},"Cart")],-1),c={class:"container mb-7"},o={class:"text-end pt-5"},r=["disabled"],d={class:"table-responsive"},u={class:"table align-middle mt-3",style:{"padding-right":"0","padding-left":"0"}},h=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{style:{width:"150px"},class:"d-none d-sm-table-cell"}),(0,s._)("th",{class:"text-start"},"產品名稱"),(0,s._)("th",{class:"text-center",style:{width:"50px"}},"數量"),(0,s._)("th",{class:"text-center"},"價格"),(0,s._)("th",{class:"text-center"},"刪除")])],-1),p={class:"text-center d-none d-sm-table-cell"},g={class:"input-group input-group-sm"},m={class:"input-group mb-3"},b=["onUpdate:modelValue","onChange","disabled"],_=["value"],f={class:"text-center"},v=(0,s._)("br",null,null,-1),w={class:"text-center"},x=["onClick"],k=(0,s._)("i",{class:"bi bi-trash"},null,-1),C=[k],y={colspan:"6",class:"text-end text-danger fw-bolder pt-3"},$={class:"fw-bolder"},I=(0,s._)("td",null,null,-1),L={class:"d-flex justify-content-between"},D=(0,s.Uk)("繼續選購"),A=(0,s.Uk)("下一步");function z(t,e,a,k,z,q){const U=(0,s.up)("LoadingVue"),Z=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(U,{active:z.isLoading,"z-index":100},null,8,["active"]),l,(0,s._)("div",c,[(0,s._)("div",o,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",disabled:0===z.cartData.carts.length,onClick:e[0]||(e[0]=(...t)=>q.removeAllCart&&q.removeAllCart(...t))}," 清空購物車 ",8,r)]),(0,s._)("div",d,[(0,s._)("table",u,[h,(0,s._)("tbody",null,[z.cartData.carts.length?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(z.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",p,[(0,s._)("div",{class:"d-none d-sm-block",style:(0,i.j5)([{height:"150px","background-size":"cover","background-position":"center center"},{backgroundImage:`url(${t.product.imageUrl})`}])},null,4)]),(0,s._)("td",null,(0,i.zw)(t.product.title),1),(0,s._)("td",null,[(0,s._)("div",g,[(0,s._)("div",m,[(0,s.wy)((0,s._)("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>q.updateCartItem(t),disabled:z.isLoadingItem===t.id,style:{width:"70px"}},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(e=>(0,s._)("option",{value:e,key:`${e}${t.id}`},(0,i.zw)(e),9,_))),64))],40,b),[[n.bM,t.qty]])])])]),(0,s._)("td",f,[(0,s._)("small",null,"單價： "+(0,i.zw)(t.product.price)+"元",1),v,(0,s.Uk)(" 合計："+(0,i.zw)(t.total)+"元 ",1)]),(0,s._)("td",w,[(0,s._)("button",{type:"button",class:"btn text-danger fs-4",onClick:e=>q.removeCartItem(t.id)},C,8,x)])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[(0,s._)("td",y,[(0,s._)("h3",$," 總價 "+(0,i.zw)(z.cartData.total)+"元 ",1)]),I])])])]),(0,s._)("div",L,[(0,s.Wm)(Z,{to:"/products",class:"btn more-btn btn-lg mt-3 fw-bolder"},{default:(0,s.w5)((()=>[D])),_:1}),(0,s.Wm)(Z,{to:"/orderform",class:(0,i.C_)(["btn add-btn btn-lg mt-3 fw-bolder",{disabled:0===z.cartData.carts.length}])},{default:(0,s.w5)((()=>[A])),_:1},8,["class"])])])],64)}var q=a(3041),U={data(){return{cartData:{carts:[]},isLoadingItem:"",isLoading:!1,originPriceTotal:0}},methods:{getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/phil/cart";this.$http.get(t).then((t=>{this.cartData=t.data.data;const e=this.cartData.carts,a=e.reduce((function(t,e){return t+parseInt(e.product.origin_price)*parseInt(e.qty)}),0);this.originalPriceTotal=a,this.isLoading=!1}))},removeCartItem(t){this.isLoadingItem=t;const e=`https://vue3-course-api.hexschool.io/v2/api/phil/cart/${t}`;this.isLoadingItem="",this.$http.delete(e).then((t=>{this.showAlert({icon:"success",title:`${t.data.message}`}),q.Z.emit("get-cart"),this.getCart()})).catch((t=>{this.showAlert({icon:"error",title:`${t.message}`})}))},updateCartItem(t){const e={product_id:t.id,qty:t.qty};this.isLoadingItem=t.id;const a=`https://vue3-course-api.hexschool.io/v2/api/phil/cart/${t.id}`;this.$http.put(a,{data:e}).then((t=>{this.getCart(),q.Z.emit("get-cart"),this.showAlert({icon:"success",title:`${t.data.message}`}),this.isLoadingItem=""})).catch((t=>{this.showAlert({icon:"error",title:`${t.message}`}),this.isLoadingItem=""}))},removeAllCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/phil/carts";this.$http.delete(t).then((t=>{this.showAlert({icon:"success",title:`${t.data.message}`}),this.getCart(),q.Z.emit("get-cart"),this.isLoading=!1})).catch((t=>{alert(t.data.message)}))},showAlert(t){this.$swal(t)}},mounted(){this.getCart(),window.scroll(0,0)}},Z=a(3744);const j=(0,Z.Z)(U,[["render",z]]);var H=j}}]);
//# sourceMappingURL=633.f37fb7f1.js.map